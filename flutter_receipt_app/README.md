# 領収書発行アプリ (Flutter版)

インボイス対応・消費税自動計算の領収書発行Flutterアプリです。端末のローカルストレージで発行者情報と履歴を管理します。

## 特徴

- 🧾 **領収書作成**: 消費税・印紙税の自動計算
- 📱 **ローカル管理**: 端末ごとにデータを安全に保存
- 🏢 **発行者管理**: 複数の発行者を登録・管理
- 📋 **履歴機能**: 作成した領収書の履歴を検索・管理
- 📄 **PDF生成**: 印刷可能なPDF領収書を生成
- 💸 **インボイス対応**: 適格請求書発行事業者登録番号に対応
- 🎨 **マテリアルデザイン**: モダンで使いやすいUI

## 主な機能

### 領収書作成
- 顧客情報入力（名前・敬称）
- 発行者選択（インボイス番号自動入力）
- 商品金額・送料入力
- 消費税（10%）自動計算
- 印紙税自動計算（電子領収書は不要）
- PDF生成・印刷

### 発行者管理
- 会社情報登録（社名・住所・電話番号）
- インボイス番号管理
- 発行者の編集・削除

### 履歴管理
- 作成済み領収書の履歴表示
- 検索機能（顧客名・内容・番号）
- 履歴からの再印刷
- 詳細表示

## セットアップ

### 前提条件
- Flutter SDK 3.10.0以上
- Dart 3.0.0以上

### インストール

1. **リポジトリのクローン**
   ```bash
   cd flutter_receipt_app
   ```

2. **依存関係のインストール**
   ```bash
   flutter pub get
   ```

3. **アプリの実行**
   ```bash
   flutter run
   ```

### ビルド

#### Android APKビルド
```bash
flutter build apk --release
```

#### iOS IPAビルド
```bash
flutter build ios --release
```

## 使用技術

- **Flutter**: クロスプラットフォーム開発
- **Dart**: プログラミング言語
- **shared_preferences**: ローカルデータ永続化
- **pdf**: PDF文書生成
- **printing**: 印刷機能
- **intl**: 国際化・日付フォーマット

## データ管理

### ローカルストレージ
- **発行者データ**: `SharedPreferences` で端末に保存
- **履歴データ**: `SharedPreferences` で端末に保存
- **自動バックアップ**: なし（端末固有のデータ）

### データ構造

#### 発行者 (Issuer)
```dart
{
  "id": 1,
  "name": "株式会社サンプル",
  "postalCode": "100-0001",
  "address": "東京都千代田区千代田1-1-1",
  "phone": "03-1234-5678",
  "invoiceNumber": "T1234567890123",
  "hankoImagePath": null
}
```

#### 領収書 (Receipt)
```dart
{
  "customerName": "田中太郎",
  "customerType": "様",
  "productAmount": 10000.0,
  "shippingAmount": 500.0,
  "description": "商品代として",
  "receiptNumber": "20231201-143022",
  "isElectronicReceipt": true,
  "issuer": { /* Issuerオブジェクト */ },
  "timestamp": "2023-12-01T14:30:22.000Z",
  "date": "2023-12-01T14:30:22.000Z"
}
```

## 税金計算

### 消費税
- **税率**: 10%（固定）
- **計算**: `(商品金額 + 送料) × 0.1`
- **表示**: 小数点以下切り捨て

### 印紙税
電子領収書は印紙税不要。紙の領収書のみ以下の税率：

| 金額範囲 | 印紙税 |
|---------|-------|
| 5万円未満 | 不要 |
| 5万円以上 | 200円 |
| 100万円以上 | 200円 |
| 500万円以上 | 400円 |
| 1000万円以上 | 600円 |
| 5000万円以上 | 1000円 |

## ライセンス

MIT License

## 連絡先

質問やフィードバックがあれば、Issuesからお知らせください。

---

**注意**: このアプリは端末ローカルでデータを管理します。端末の初期化や削除を行うとデータが失われる可能性があります。重要なデータは定期的にバックアップすることをお勧めします。